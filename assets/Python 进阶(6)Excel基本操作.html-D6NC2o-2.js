import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e as t}from"./app-fe-qs-fC.js";const p="/assets/651-DMdYXLYj.jpg",e="/assets/652-WD6YIL0-.jpg",o="/assets/653-B6hpZaDH.jpg",c={},l=t(`<h2 id="_1-概述" tabindex="-1"><a class="header-anchor" href="#_1-概述"><span>1.概述</span></a></h2><p>在现实中，很多工作都需要与数据打交道，Excel 作为常用的数据处理工具，一直备受人们的青睐，而大部分人都是手动操作 Excel，如果数据量较小且是一些简单的操作还好说，但如果数据量较大或是一些复杂的操作，工作量可想而知，因此，我们需要掌握一种简单、高效的方法来操作 Excel。</p><p>在数据处理方面，Python 一直扮演着重要的角色，对于 Excel 操作，它有着完整且成熟的第三方库，使用也较为简单。</p><p>Python 中常用 Excel 操作库如下：</p><ul><li><strong>xlrd</strong>：从 Excel 中读取数据，支持 xls、xlsx。</li><li><strong>xlwt</strong>：向 Excel 中写入数据，支持 xls。</li><li><strong>xlutils</strong>：提供了一些 Excel 的实用操作，比如复制、拆分、过滤等，通常与 xlrd、xlwt 一起使用。</li><li><strong>XlsxWriter</strong>：向 Excel 中写入数据，支持 xlsx。</li><li><strong>openpyxl</strong> ：用于读写 Excel，支持 xlsx。</li></ul><h2 id="_2-写入" tabindex="-1"><a class="header-anchor" href="#_2-写入"><span>2.写入</span></a></h2><h3 id="_2-1-使用-xlwt" tabindex="-1"><a class="header-anchor" href="#_2-1-使用-xlwt"><span>2.1 使用 xlwt</span></a></h3><p>安装：</p><p>执行：<code>pip install xlwt</code>进行安装</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> xlwt

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建工作簿</span>
    wb <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建表单</span>
    sh <span class="token operator">=</span> wb<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建字体</span>
    font <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 字体加粗</span>
    font<span class="token punctuation">.</span>bold <span class="token operator">=</span> <span class="token boolean">True</span>
    alm <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Alignment<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置左对齐</span>
    alm<span class="token punctuation">.</span>horz <span class="token operator">=</span> <span class="token number">0x01</span>
    <span class="token comment"># 创建样式</span>
    style1 <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    style2 <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    style1<span class="token punctuation">.</span>font <span class="token operator">=</span> font
    style2<span class="token punctuation">.</span>alignment <span class="token operator">=</span> alm
    <span class="token comment"># write 方法参数1：行，参数2：列，参数3：内容</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span> style1<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;年龄&#39;</span><span class="token punctuation">,</span> style1<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> style2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> style2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;王五&#39;</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> style2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;赵六&#39;</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> style2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;平均年龄&#39;</span><span class="token punctuation">,</span> style1<span class="token punctuation">)</span>
    <span class="token comment"># 保存</span>
    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;test.xls&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行结果：</p><figure><img src="`+p+`" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><h3 id="_2-2-使用-xlsxwriter" tabindex="-1"><a class="header-anchor" href="#_2-2-使用-xlsxwriter"><span>2.2 使用 XlsxWriter</span></a></h3><p>安装：</p><p>执行：<code>pip install XlsxWriter</code>命令进行安装</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> xlsxwriter

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建工作簿</span>
    workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">&#39;test.xlsx&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建表单</span>
    sh <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span>
    fmt1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 字体加粗</span>
    fmt1<span class="token punctuation">.</span>set_bold<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置左对齐</span>
    fmt2<span class="token punctuation">.</span>set_align<span class="token punctuation">(</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;年龄&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;王五&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;赵六&#39;</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;平均年龄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt1<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A2&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A3&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A4&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A5&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A6&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt1<span class="token punctuation">)</span>
    chart <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>XlsxWriter 可以很方便的生成图表。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> xlsxwriter

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建工作簿</span>
    wk <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">&#39;test.xlsx&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建表单</span>
    sh <span class="token operator">=</span> wk<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span>
    fmt1 <span class="token operator">=</span> wk<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt2 <span class="token operator">=</span> wk<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 字体加粗</span>
    fmt1<span class="token punctuation">.</span>set_bold<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置左对齐</span>
    fmt2<span class="token punctuation">.</span>set_align<span class="token punctuation">(</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># 数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;年龄&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;张三&#39;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李四&#39;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;王五&#39;</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;赵六&#39;</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">&#39;平均年龄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A1&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt1<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A2&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A3&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A4&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A5&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt2<span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token string">&#39;A6&#39;</span><span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fmt1<span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;
    area：面积图
    bar：直方图
    column：柱状图
    line：折线图
    pie：饼图
    doughnut：环形图
    radar：雷达图
    &#39;&#39;&#39;</span>
    chart <span class="token operator">=</span> wk<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;type&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建图表</span>
    chart<span class="token punctuation">.</span>add_series<span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;=test!$B$1&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;categories&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;=test!$B$2:$B$5&#39;</span><span class="token punctuation">,</span>
            <span class="token string">&#39;values&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;=test!$C$2:$C$5&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
    chart<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;用户年龄折线图&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    chart<span class="token punctuation">.</span>set_x_axis<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    chart<span class="token punctuation">.</span>set_y_axis<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;年龄&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    sh<span class="token punctuation">.</span>insert_chart<span class="token punctuation">(</span><span class="token string">&#39;A9&#39;</span><span class="token punctuation">,</span> chart<span class="token punctuation">)</span>
    wk<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行结果：</p><figure><img src="`+e+`" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><h2 id="_3-读取" tabindex="-1"><a class="header-anchor" href="#_3-读取"><span>3.读取</span></a></h2><p>安装</p><p>执行<code>pip install xlrd</code> 命令安装。</p><p>不支持<code>xlsx</code>类型文件：<mark>xlrd.biffh.XLRDError: Excel xlsx file; not supported</mark></p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> xlrd

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token comment"># 打开</span>
    wb <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&#39;E:\\\\python_projects\\\\basicStudy\\\\test.xlsx&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;sheet名称:&#39;</span><span class="token punctuation">,</span> wb<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;sheet数量:&#39;</span><span class="token punctuation">,</span> wb<span class="token punctuation">.</span>nsheets<span class="token punctuation">)</span>
    <span class="token comment"># 根据 sheet 索引获取 sheet</span>
    sh <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment"># 根据 sheet 名称获取 sheet</span>
    <span class="token comment"># sh = wb.sheet_by_name(&#39;test&#39;)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">u&#39;sheet %s 有 %d 行&#39;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sh<span class="token punctuation">.</span>name<span class="token punctuation">,</span> sh<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">u&#39;sheet %s 有 %d 列&#39;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>sh<span class="token punctuation">.</span>name<span class="token punctuation">,</span> sh<span class="token punctuation">.</span>ncols<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;第二行内容:&#39;</span><span class="token punctuation">,</span> sh<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;第三列内容:&#39;</span><span class="token punctuation">,</span> sh<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;第二行第三列的值为:&#39;</span><span class="token punctuation">,</span> sh<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;第二行第三列值的类型为:&#39;</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-修改" tabindex="-1"><a class="header-anchor" href="#_4-修改"><span>4.修改</span></a></h2><p>之前写入的数据还有一个平均年龄是空着的，我们先读取之前写入的数据，再计算出平均值，最后将平均值写入。这里要用到 xlutils 模块</p><p>安装：</p><p>执行<code>pip install xlutils</code> 安装。</p><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token keyword">import</span> xlrd<span class="token punctuation">,</span> xlwt
<span class="token keyword">from</span> xlutils<span class="token punctuation">.</span>copy <span class="token keyword">import</span> copy

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sumv <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sumv <span class="token operator">+=</span> <span class="token builtin">list</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sumv <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


    <span class="token comment"># formatting_info 为 True 表示保留原格式</span>
    wb <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">&#39;test.xls&#39;</span><span class="token punctuation">,</span> formatting_info<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment"># 复制</span>
    wbc <span class="token operator">=</span> copy<span class="token punctuation">(</span>wb<span class="token punctuation">)</span>
    sh <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    age_list <span class="token operator">=</span> sh<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    age_list <span class="token operator">=</span> age_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>age_list<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
    avg_age <span class="token operator">=</span> avg<span class="token punctuation">(</span>age_list<span class="token punctuation">)</span>
    sh <span class="token operator">=</span> wbc<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment"># 设置左对齐</span>
    alm <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Alignment<span class="token punctuation">(</span><span class="token punctuation">)</span>
    alm<span class="token punctuation">.</span>horz <span class="token operator">=</span> <span class="token number">0x01</span>
    style <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
    style<span class="token punctuation">.</span>alignment <span class="token operator">=</span> alm
    sh<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> avg_age<span class="token punctuation">,</span> style<span class="token punctuation">)</span>
    wbc<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&#39;test.xls&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行结果：</p><figure><img src="`+o+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure>',32),i=[l];function u(k,r){return s(),a("div",null,i)}const v=n(c,[["render",u],["__file","Python 进阶(6)Excel基本操作.html.vue"]]),b=JSON.parse('{"path":"/notes/python/%E8%BF%9B%E9%98%B6/Python%20%E8%BF%9B%E9%98%B6(6)Excel%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.html","title":"Python 进阶(6)Excel基本操作","lang":"zh-CN","frontmatter":{"title":"Python 进阶(6)Excel基本操作","date":"2024-05-18T00:00:00.000Z","description":"1.概述 在现实中，很多工作都需要与数据打交道，Excel 作为常用的数据处理工具，一直备受人们的青睐，而大部分人都是手动操作 Excel，如果数据量较小且是一些简单的操作还好说，但如果数据量较大或是一些复杂的操作，工作量可想而知，因此，我们需要掌握一种简单、高效的方法来操作 Excel。 在数据处理方面，Python 一直扮演着重要的角色，对于 Ex...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/notes/python/%E8%BF%9B%E9%98%B6/Python%20%E8%BF%9B%E9%98%B6(6)Excel%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C.html"}],["meta",{"property":"og:site_name","content":"曹云友的博客"}],["meta",{"property":"og:title","content":"Python 进阶(6)Excel基本操作"}],["meta",{"property":"og:description","content":"1.概述 在现实中，很多工作都需要与数据打交道，Excel 作为常用的数据处理工具，一直备受人们的青睐，而大部分人都是手动操作 Excel，如果数据量较小且是一些简单的操作还好说，但如果数据量较大或是一些复杂的操作，工作量可想而知，因此，我们需要掌握一种简单、高效的方法来操作 Excel。 在数据处理方面，Python 一直扮演着重要的角色，对于 Ex..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-18T14:07:01.000Z"}],["meta",{"property":"article:author","content":"曹云友"}],["meta",{"property":"article:published_time","content":"2024-05-18T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-18T14:07:01.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Python 进阶(6)Excel基本操作\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-05-18T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-18T14:07:01.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"曹云友\\",\\"url\\":\\"https://caoyunyou.github.io\\"}]}"]]},"headers":[{"level":2,"title":"1.概述","slug":"_1-概述","link":"#_1-概述","children":[]},{"level":2,"title":"2.写入","slug":"_2-写入","link":"#_2-写入","children":[{"level":3,"title":"2.1 使用 xlwt","slug":"_2-1-使用-xlwt","link":"#_2-1-使用-xlwt","children":[]},{"level":3,"title":"2.2 使用 XlsxWriter","slug":"_2-2-使用-xlsxwriter","link":"#_2-2-使用-xlsxwriter","children":[]}]},{"level":2,"title":"3.读取","slug":"_3-读取","link":"#_3-读取","children":[]},{"level":2,"title":"4.修改","slug":"_4-修改","link":"#_4-修改","children":[]}],"git":{"createdTime":1716041221000,"updatedTime":1716041221000,"contributors":[{"name":"曹云友","email":"caoyunyou@foxmail.com","commits":1}]},"readingTime":{"minutes":3.38,"words":1015},"filePathRelative":"notes/python/进阶/Python 进阶(6)Excel基本操作.md","localizedDate":"2024年5月18日","excerpt":"<h2>1.概述</h2>\\n<p>在现实中，很多工作都需要与数据打交道，Excel 作为常用的数据处理工具，一直备受人们的青睐，而大部分人都是手动操作 Excel，如果数据量较小且是一些简单的操作还好说，但如果数据量较大或是一些复杂的操作，工作量可想而知，因此，我们需要掌握一种简单、高效的方法来操作 Excel。</p>\\n<p>在数据处理方面，Python 一直扮演着重要的角色，对于 Excel 操作，它有着完整且成熟的第三方库，使用也较为简单。</p>\\n<p>Python 中常用 Excel 操作库如下：</p>\\n<ul>\\n<li><strong>xlrd</strong>：从 Excel 中读取数据，支持 xls、xlsx。</li>\\n<li><strong>xlwt</strong>：向 Excel 中写入数据，支持 xls。</li>\\n<li><strong>xlutils</strong>：提供了一些 Excel 的实用操作，比如复制、拆分、过滤等，通常与 xlrd、xlwt 一起使用。</li>\\n<li><strong>XlsxWriter</strong>：向 Excel 中写入数据，支持 xlsx。</li>\\n<li><strong>openpyxl</strong> ：用于读写 Excel，支持 xlsx。</li>\\n</ul>","autoDesc":true}');export{v as comp,b as data};
